---
title: pythonè¯­è¨€è¿›é˜¶
date: 2022-05-18 10:15:21
pageClass: custom-series-page-class
categories:
- pythonğŸ
tags:
- pythonğŸ
---

:::tip ğŸ“ŒTip
pythonçš„è¿›é˜¶æé«˜ï¼Œæ³¢æ¯”å¾ˆç»å…¸çš„è¯¾äº†ï¼Œé…åˆ[cookbook](https://python3-cookbook.readthedocs.io/zh_CN/latest/index.html)å’Œ[æ–‡æ¡£](https://docs.python.org/zh-cn/3.9/)  
å†™çš„å¯èƒ½ä¼šå¾ˆé•¿
:::
<!-- more -->

[[toc]]

<div align="center"><h1><strong> pythonè¯­è¨€è¿›é˜¶</strong></h1></div>

åŠ¨æ€è¯­è¨€åªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰èƒ½å‘ç°é”™è¯¯ï¼Œè¿™æ˜¯å›ºæœ‰ç¼ºç‚¹  
[cookbook](https://python3-cookbook.readthedocs.io/zh_CN/latest/index.html)

## æ·±å…¥OOP
å¤šæ·±æ‰èƒ½å«æ·±å…¥å‘¢ï¼Ÿ  
ä¿æŒè°¦æŠ‘  
### pythonä¸­çš„ä¸€åˆ‡çš†å¯¹è±¡
pythonæ¯”javaçš„ä¸€åˆ‡çš†å¯¹è±¡æ›´åŠ å½»åº•ï¼Œæ‰€ä»¥æ›´åŠ çµæ´»ï¼Œå…¶çµæ´»æ€§å°±æ˜¯é è¿™å®ç°çš„  
javaä¸­Objectæ˜¯classçš„ä¸€ä¸ªå®ä¾‹ï¼Œä½†æ˜¯åœ¨pyä¸­**ç±»class**ä¹Ÿæ˜¯å¯¹è±¡ï¼Œ**å‡½æ•°**ï¼Œä»£ç å’Œæ¨¡å—ä¹Ÿæ˜¯å¯¹è±¡ã€‚éƒ½å¯ä»¥è¢«åŠ¨æ€çš„èµ‹å€¼ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰pythonçš„è¿·æƒ‘æ“ä½œ[æˆ‘å†™æˆ‘è‡ªå·±](https://www.bilibili.com/video/BV1pU4y1m7kf)  
ä¸€åˆ‡éƒ½æ˜¯"ä¸€ç­‰å…¬æ°‘"æ„å‘³ç€å¯ä»¥  

1. èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡
2. å¯ä»¥æ·»åŠ åˆ°é›†åˆå¯¹è±¡ä¸­ 
3. å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°
4. å¯ä»¥å½“åšå‡½æ•°çš„è¿”å›å€¼ï¼ˆé—­åŒ…åŸç†ï¼‰

æŒ‰ç…§å†…å­˜æ¨¡å‹ç†è§£æ‰€æœ‰çš„**å˜é‡**éƒ½æ˜¯å½»åº•çš„â€œå¼•ç”¨â€ï¼ŒæŒ‡å‘å®é™…çš„å†…å­˜ï¼Œå˜é‡å¯ä»¥è¢«ä»»æ„å¼•ç”¨  
æ‰€ä»¥pythonä¸ç”¨å®ç°å¤šæ€ï¼Œé¸­å­å°±å·²ç»å¾ˆå¤šæ€äº†ã€‚pythonæ”¯æŒå¤šç»§æ‰¿ï¼Œå°è£…çš„æ³¨æ„åœ¨åŸºç¡€éƒ¨åˆ†æœ‰  
### ç±»çš„æºå¤´
æ¢³ç†ä¸€ä¸‹å…³ç³»  
typeæ˜¯å¯ä»¥åˆ›å»ºç±»çš„  
typeç±»ç”Ÿæˆäº†classï¼Œclassç”Ÿæˆäº†å¯¹è±¡ï¼Œ`type->class->otherObject`  
å†…ç½®ç±»å‹åŸºæœ¬éƒ½æ˜¯classç±»å‹ï¼Œtypeå¥—å¨ƒä¸¤æ¬¡è¿”å›çš„å°±æ˜¯typeç±»  
`type(type(int)) : <class 'type'>`  

`object`æ˜¯æ‰€æœ‰ç±»éƒ½è¦ç»§æ‰¿çš„é¡¶å±‚åŸºç±»ï¼Œ`class Class()`åé¢æ‹¬å·ä¸å†™ä¸œè¥¿é»˜è®¤ç»§æ‰¿é¡¶å±‚åŸºç±» psç°åœ¨åŠ ä¸åŠ éƒ½ä¸€æ ·ä½†æ˜¯æœ‰äº›äººçš„ä»£ç ä¼šæœ‰æ‰€åŒºåˆ†ï¼Œå› ä¸ºpy2ä¸­æ˜¯ä¸ä¸€æ ·  

![](./static/pythonè¯­è¨€è¿›é˜¶-images-1.png)

:::tip ğŸ“Note
**typeå’Œobjectçš„å…³ç³»**<br/>`type`æœ¬èº«æ—¢æ˜¯ç±»åˆæ˜¯å¯¹è±¡ï¼Œ`type`ç»§æ‰¿è‡ª`object`  
`object.__base__`è¿”å›æ˜¯()ç©º,è€Œ`type(object)`æ˜¯`type`ç±»å‹ 
  
ä¸Šå›¾ä¸­å¾ˆå¥‡æ€ªçš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯pythonä¸­æœ‰ä¸¤ä¸ªç¥åŒæ—¶çº ç¼ å‡ºç°  
  
`type`çš„çˆ¶ç±»æ˜¯`type`å®ä¾‹åŒ–çš„ï¼Œç„¶è€Œ`type`ç»§æ‰¿äº†çˆ¶ç±»ï¼Œæ—¶é—´åœ¨æ­¤æ—¶æ¶ˆå¤±äº†ã€‚
ä»Cçš„è§’åº¦ç†è§£ï¼Œä¸€å¼€å§‹ç”³è¯·äº†ä¿©å†…å­˜å—ï¼Œå†å¼€å§‹è§£é‡Špython  
  
`type`æ­¤æ—¶å¯ä»¥å¼€å§‹æ„å»ºä¸‡ç‰©ï¼Œæ‰€æœ‰çš„ç±»ï¼Œå¯¹è±¡ï¼Œéƒ½æ˜¯ä»–æ´¾ç”Ÿçš„ï¼Œè‡ªå·±(ç±»)å®ä¾‹åŒ–ç”Ÿæˆè‡ªå·±(ç±»)  
ä»Cçš„è§’åº¦ç†è§£ï¼Œ`type`çš„æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå†…å­˜å—ï¼Œå†…å­˜å—è‡ªè¡Œå¤åˆ¶ä¸€æ¬¡å°±å¯ä»¥ã€‚

:::

### ç±»å±æ€§å’Œå®ä¾‹å±æ€§
#### å˜é‡æƒé™å‘½åè§„èŒƒ
`_`å¯ä»¥è®¿é—®ä½†ä¸å»ºè®®  
`__`ç§æœ‰å˜é‡ï¼ˆprivateï¼‰ä¸èƒ½ç›´æ¥è®¿é—®`__name`æ˜¯å› ä¸ºPythonè§£é‡Šå™¨å¯¹å¤–æŠŠ`__name`å˜é‡æ”¹æˆäº†`ClassName._ClassName__name`  
`__xxx__`æ˜¯ç‰¹æ®Šå˜é‡ã€‚  

#### å˜é‡æŸ¥æ‰¾é¡ºåº

^5e3db7

å¤§è‡´æ˜¯<span style="background:greenyellow">ç”±ä¸‹è€Œä¸ŠæŸ¥æ‰¾</span>
ä¼˜å…ˆæŸ¥æ‰¾ **å¯¹è±¡** å˜é‡ï¼Œæ‰¾ä¸åˆ°å°±å‘ä¸ŠæŸ¥æ‰¾ **ç±»** å˜é‡ã€‚  
ä¿®æ”¹ **å¯¹è±¡** çš„ **ç±»å˜é‡** æ—¶ä¸ä¼šæ›´æ”¹ **ç±»** çš„ **ç±»å˜é‡** ï¼Œåªæ˜¯ç»™å¯¹è±¡è‡ªå·±æ·»åŠ äº†ä¸€ä¸ª **å¯¹è±¡å˜é‡** è¦†ç›–äº† **ç±»å˜é‡** ï¼Œæ‰€ä»¥å…¶ä»–å¯¹è±¡å’Œç±»çš„ **ç±»å˜é‡** ä¸å˜  
  
ä¿®æ”¹ **ç±»å˜é‡** çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ **å¯¹è±¡** çš„ **å˜é‡** éƒ½å˜ï¼Œå› ä¸ºç±»å˜é‡æ˜¯å…±äº«çš„  
å­ç±»ä¿®æ”¹äº†ç±»å˜é‡æ—¶åªæœ‰å­ç±»é“¾æ¡ä¸‹ç”Ÿæ•ˆ  


#### å¤šç»§æ‰¿ä¸‹æœç´¢
åœ¨å•ç»§æ‰¿è¿™æ ·å°±å¤Ÿäº†ï¼Œä½†æ˜¯å¤šç»§æ‰¿å°±å¯„äº†ã€‚  
pyçš„**æ–¹æ³•è§£æé¡ºåº**ï¼ˆMethod Resolution Orderï¼Œ**MRO**ï¼‰ä½¿ç”¨çš„æ˜¯C3ç®—æ³•ï¼Œpython2.3å‰ä½¿ç”¨çš„æ˜¯DFSæˆ–BFSï¼Œä½†æ˜¯è¿™æ ·æ— æ³•è§£å†³è±å½¢ç»§æ‰¿  
C3ç®—æ³•å®ç°äº†ä¸‰ç§é‡è¦ç‰¹æ€§ï¼š
-   ä¿æŒç»§æ‰¿[æ‹“æ‰‘å›¾](https://link.zhihu.com/?target=https%3A//zh.wikipedia.org/w/index.php%3Ftitle%3D%25E6%258B%2593%25E6%2589%2591%25E5%259B%25BE%26action%3Dedit%26redlink%3D1)çš„ä¸€è‡´æ€§ã€‚
-   ä¿è¯å±€éƒ¨ä¼˜å…ˆåŸåˆ™ï¼ˆæ¯”å¦‚A-->C-->Bï¼Œé‚£ä¹ˆAè¯»å–çˆ¶ç±»æ–¹æ³•ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨Cçš„æ–¹æ³•è€Œä¸æ˜¯Bçš„æ–¹æ³•ï¼‰ã€‚
-   ä¿è¯å•è°ƒæ€§åŸåˆ™ï¼ˆå³å­ç±»ä¸æ”¹å˜çˆ¶ç±»çš„æ–¹æ³•æœç´¢é¡ºåºï¼‰ã€‚

ç±»çš„`__mro__`å±æ€§æˆ–`mro()`æ–¹æ³•å¯ä»¥ç›´æ¥æŸ¥çœ‹æœç´¢é¡ºåºï¼ŒC3ä¼šæŒ‰ç…§å¤šç»§æ‰¿çš„å‚æ•°é¡ºåºè¿›è¡Œæœç´¢ã€‚ä¸‰è§’ç»§æ‰¿ä¼šç›´æ¥æŠ¥é”™æ— æ³•è¿›è¡Œmro
![|700](./static/pythonè¯­è¨€è¿›é˜¶-images-2.png)

### æ„é€ ææ„
#### å®ä¾‹æ–¹æ³•
ä¸€èˆ¬çš„æ–¹æ³•éƒ½æ˜¯å®ä¾‹æ–¹æ³•ï¼Œåªé’ˆå¯¹å®ä¾‹è¿›è¡Œæ“ä½œï¼Œä¼šä¼ å…¥selfï¼Œ`cls.func()`è°ƒç”¨çš„æ—¶å€™ï¼Œpythonä¼šè‡ªåŠ¨è½¬æˆ`func(cls)`  
#### é™æ€æ–¹æ³•
å¯¹è±¡æ„é€ å‰å¤„ç†è¾“å…¥ï¼Œå¯¹è±¡è¿˜æ²¡æœ‰æ„é€ å‡ºæ¥ï¼Œæ¯æ¬¡éƒ½è¦å¤„ç†ä¸æ˜¯å¾ˆè§„èŒƒ  
ä½¿ç”¨è£…é¥°å™¨`@staticmethod`  
åœ¨ç±»ä¸­å®šä¹‰æ–¹æ³•ï¼Œä¸éœ€è¦ä¼ å…¥selfï¼Œå¯ä»¥é€šè¿‡ç±»ç›´æ¥è°ƒç”¨ï¼Œå¥½å¤„æ˜¯å°†å‘½åç©ºé—´å’Œå¤„ç†æ‹¿åˆ°äº†ç±»é‡Œé¢å»ï¼Œå¯ä»¥ç›´æ¥è¿”å›å¯¹è±¡ã€‚  
åå¤„å°±æ˜¯ç±»åæ˜¯ç¡¬ç¼–ç ï¼Œä¿®æ”¹ç±»åçš„æ—¶å€™éœ€è¦å»ä¿®æ”¹ï¼Œå¦‚æœåªæ˜¯å¤„ç†å’Œåˆ¤æ–­æ˜¯å¦è§„èŒƒï¼Œä¸éœ€è¦è¿”å›å¯¹è±¡ï¼Œå°±å¯ä»¥ç”¨é™æ€æ–¹æ³•  
æ‰€ä»¥åœ¨è¿™ç§åŠ¨æ€çš„æ„é€ éœ€æ±‚ä¸‹ï¼Œå°±éœ€è¦ç”¨ç±»æ–¹æ³•`@classmethod`  
ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºclsï¼Œä»£è¡¨ç±»æœ¬èº«ã€‚  
:::details Click to see more

```python
class Dates:  # å‡è®¾è¦æ‹¿åˆ°æ—¶é—´  
    def __init__(self, yy, mm, dd):  
        self.yy = yy  
        self.mm = mm  
        self.dd = dd  
  
    def __str__(self):  
        return "{yy}å¹´,{mm}æœˆ,{dd}æ—¥".format(yy=self.yy, mm=self.mm, dd=self.dd)  
  
    @staticmethod  # é™æ€æ–¹æ³•è£…é¥°å™¨  
    def test_string(string):  # ä¸ç”¨ä¼ å…¥selfç­‰  
        # l = string.split("-")  
        # return Dates(l[0], l[1], l[2]) # ç¡¬ç¼–ç åˆ›å»º  
        try:  
            l = string.split("-")  
            for i in l:  
                int(i)  
            return True  
        except Exception as e:  
            return False  
  
    @classmethod  # ç±»æ–¹æ³•è£…é¥°å™¨  
    def create_from_string(cls, string):  # ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºcls  
        l = string.split("-")  
        return cls(l[0], l[1], l[2])  # åŠ¨æ€åˆ›å»º  
  
  
d1 = Dates(21, 2, 3)  
print(d1)  
check = Dates.test_string("21-2-3")  
d2 = Dates.create_from_string("21-2-4")  
print(d2, check)  
  
print("------------")  
  
  
class MordenDate(Dates): # æ˜¯å¯ä»¥ç»§æ‰¿çš„  
  
    morden = 1  
  
    @staticmethod  # é™æ€æ–¹æ³•è£…é¥°å™¨  
    def test_string(string):  # ç»§æ‰¿ä¹‹å  
        print("I am a ModernDate")  
        try:  
            l = string.split("-")  
            for i in l:  
                int(i)  
            return True  
        except Exception as e:  
            return False  
  
md1 = MordenDate(22, 5, 3)  
print(md1)  
mcheck = MordenDate.test_string("22-5-8")  
md2 = MordenDate.create_from_string("22-5-8")  
excheck=isinstance(md2,MordenDate) # ç»§æ‰¿åæ˜¯å¦åŠ¨æ€åˆ›å»º  
print(md2,excheck, mcheck)
```
è¿è¡Œç»“æœ
```
21å¹´,2æœˆ,3æ—¥
21å¹´,2æœˆ,4æ—¥ True
------------
22å¹´,5æœˆ,3æ—¥
I am a ModernDate
22å¹´,5æœˆ,8æ—¥ True True
```
:::

#### `__new__`å’Œ`__init__`
 ^e46b78
  
`__new__`çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»æœ¬èº«ï¼Œè€Œ`__init__`ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯å¯¹è±¡æœ¬èº«ï¼Œnewæ˜¯ç®¡å¯¹è±¡ç”Ÿæˆå‰çš„åŠ¨ä½œï¼Œinitæ˜¯å®Œå–„å¯¹è±¡æœ¬èº«  
newä¼šé€šè¿‡å¯å˜å‚æ•°æå‰è·å–åˆ°åˆå§‹åŒ–ä¼ å…¥çš„å±æ€§ï¼Œå¿…é¡»return`super().__new__(cls)`å›å»ï¼Œä¸ç„¶æ²¡æ³•è°ƒç”¨initç»§ç»­åˆ›å»º  
```python
class A():  
    def __new__(cls, *args, **kwargs):  # ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘çš„æ˜¯ç±»æœ¬èº«  
        print("new...")  
        return super().__new__(cls) # æ³¨æ„è¿”å›ä»€ä¹ˆ  
    def __init__(self,name):  
        print("Initializing...")  
        self.name=name  
a=A(name="hhh")

#----ç»“æœ----
new...
Initializing...
```
ä¸»è¦æ˜¯åœ¨å…ƒç±»ç¼–ç¨‹ä¸­ç”¨çš„å¤š
### è‡ªçœæœºåˆ¶
[å˜é‡æŸ¥æ‰¾é¡ºåº](#^5e3db7)  
ä½¿ç”¨`obj.__dict__`æŸ¥çœ‹<span style="background:greenyellow">å¯¹è±¡</span>æ‰€æœ‰çš„å±æ€§,æ­¤æ—¶å‘ç°ç±»å’Œçˆ¶ç±»ä¸­çš„å±æ€§éƒ½æ²¡æœ‰å‡ºç°ï¼Œå› ä¸ºä»–æ˜¯ä¹‹æŸ¥çœ‹è¿™ä¸ªå¯¹è±¡çš„ã€‚  
æŸ¥çœ‹ **ç±»å¯¹è±¡** çš„å±æ€§ï¼ŒåŒæ—¶å¯ä»¥å½“å­—å…¸å–å‡ºå±æ€§  
ä¹‹æ‰€ä»¥èƒ½è°ƒç”¨å°±æ˜¯MROåšçš„  
ä½¿ç”¨`__dict__`å¯ä»¥æŸ¥çœ‹ç”šè‡³ä¿®æ”¹å·²æœ‰çš„å±æ€§æ·»åŠ æ–°çš„ï¼Œ<span style="background:greenyellow">åªæœ‰å¯¹è±¡å®ä¾‹æ‰èƒ½æ·»åŠ </span>ï¼Œç»™ç±»æ·»åŠ è¢«è§£é‡Šå™¨é˜»æ­¢äº†  
ä½¿ç”¨`dir(obj)`å¯ä»¥åˆ—å‡ºæ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬ç±»ç³»ç»Ÿå†…å»ºçš„ï¼Œä½†æ˜¯æ²¡æœ‰å€¼åªæœ‰åç§°  
ä¸€äº›å†…ç½®ç±»å‹æ²¡æœ‰`__dict__`ä½†æ˜¯éƒ½å¯ä»¥ä½¿ç”¨`dir()`

:::details Click to see more

```python
# ç§æœ‰å˜é‡  
class A():  
    a=1  
    pass  
class B(A):  
    """ # æ³¨æ„'__doc__' å±æ€§
    doc    
    """    
    b=2  
    def __init__(self,x):  
        self.x=x  
b=B(5)  
print(b.__dict__,"\n",B.__dict__,"\n")  
b.__dict__["add"]="add success"  # å¯¹è±¡æ·»åŠ å±æ€§
print(b.__dict__,"\n",dir(B),)
```
è¿è¡Œç»“æœ
```
{'x': 5} 
 {'__module__': '__main__', '__doc__': '\n    doc\n    ', 'b': 2, '__init__': <function B.__init__ at 0x10e5e0820>}  

{'x': 5, 'add': 'add success'} 
 ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'a', 'b'] 
```
:::
#### super()çš„ç”¨æ³•
åœ¨ç»§æ‰¿ä¸­ï¼Œå¦‚æœé‡å®šä¹‰æŸæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¦†ç›–çˆ¶ç±»çš„åŒåæ–¹æ³•ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›èƒ½åŒæ—¶å®ç°çˆ¶ç±»çš„åŠŸèƒ½ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•äº†ã€‚  
è°ƒç”¨çˆ¶ç±»åŒåæ–¹æ³•æœ‰ä¸¤ç§æ–¹å¼ï¼š  
1. è°ƒç”¨æœªç»‘å®šçš„çˆ¶ç±»æ–¹æ³•
    - å¤šç»§æ‰¿æ—¶ä¼šå¯¼è‡´å¤šæ¬¡è°ƒç”¨æ–¹æ³•
2. ä½¿ç”¨superå‡½æ•°æ¥è°ƒç”¨
    - æœ€å¸¸è§çš„å°±æ˜¯ä½¿ç”¨`super().__init__()`
Python 3 å¯ä»¥ä½¿ç”¨ç›´æ¥ä½¿ç”¨ `super().xxx`ä»£æ›¿ `super(Class, self).xxx`  
`super()`ä¸æ˜¯ç›´æ¥è°ƒç”¨çˆ¶ç±»ï¼Œè€Œæ˜¯æŒ‰ç…§MROé¡ºåºè¿›è¡Œæ„é€   

### Mixinæ··åˆæ¨¡å¼
- æ··åˆä¼˜äºç»§æ‰¿
- MixinåŠŸèƒ½å•ä¸€
    - Mixinåªå®ç°äº†æŸäº›å•ä¸€çš„åŠŸèƒ½ï¼Œå¯ä»¥åˆ©ç”¨ç»§æ‰¿æ¥ç»„åˆè¿™äº›åŠŸèƒ½
    - è”æƒ³é­”æ³•å‡½æ•°åŸºäºåè®®çš„ç¼–ç¨‹ï¼Œoopä¸­å°±ä½¿ç”¨mixin
- ä¸å’ŒåŸºç±»å…³è”ï¼Œå¯ä»¥ä»»æ„ç»„åˆ
- åœ¨Mixinä¸­ä¸è¦ä½¿ç”¨super
- æ··å…¥ç±»ä¸èƒ½ç›´æ¥è¢«å®ä¾‹åŒ–ä½¿ç”¨ã€‚
- æ··å…¥ç±»æ²¡æœ‰è‡ªå·±çš„çŠ¶æ€ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬å¹¶æ²¡æœ‰å®šä¹‰ `__init__()` æ–¹æ³•ï¼Œå¹¶ä¸”æ²¡æœ‰å®ä¾‹å±æ€§ã€‚
  
ä¸»è¦æ˜¯æŒæ¡ç¼–ç¨‹æ€æƒ³ï¼Œcookbooké‡Œæœ‰[è¿™ä¸€ç« ](https://python3-cookbook.readthedocs.io/zh_CN/latest/c08/p18_extending_classes_with_mixins.html)çš„ç¤ºä¾‹ã€‚
  
### æŠ½è±¡åŸºç±»(æŒæ¡æ€æƒ³)
abcæŠ½è±¡åŸºç±»(abstract base class)æ˜¯æ— æ³•å®ä¾‹åŒ–çš„ï¼Œç»§æ‰¿æŠ½è±¡åŸºç±»å¿…é¡»è¦å®ç°åŸºç±»è§„å®šçš„æŸäº›æ–¹æ³•  
æ‰€æœ‰çš„æŠ½è±¡åŸºç±»çš„metaclasså‚æ•°éƒ½å¿…é¡»æ˜¯`metaclass=ABCMeta`  
ä¸¤ç§æƒ…å†µä¸‹éœ€è¦æŠ½è±¡åŸºç±»  
- ä¸€æ˜¯åˆ¤å®šèƒ½ä¸èƒ½ä½¿ç”¨æŸäº›æ–¹æ³•ï¼Œæ¯”å¦‚æ˜¯å¦å®ç°äº†len 
- äºŒæ˜¯è§„å®šå­ç±»å¿…é¡»å®ç°æŸäº›æ–¹æ³•ã€‚  
è¿™æ ·åœ¨å®ç°æŸäº›åŠŸèƒ½çš„æ›¿ä»£å’Œæ‰©å±•çš„æ—¶å€™ï¼Œå°±æ— éœ€ä¿®æ”¹åŸæ¥çš„ä»£ç ï¼Œç›´æ¥ç»§æ‰¿å¹¶ä¸”å®ç°é¢„ç•™çš„æ¥å£å°±å¯ä»¥äº†  
å¼•å…¥å†…ç½®åŒ…`abc`  
:::details Click to see more

```python
# å‡è®¾æˆ‘ä»¬ç»§æ‰¿Cacheå®ç°RedisCache  
import abc
class Cache(object, metaclass=abc.ABCMeta):  
  
    @abc.abstractmethod  
    def get(self):  
        pass  
  
    @abc.abstractmethod  
    def set(self):  
        pass  
  
  
class RedisCache(Cache):  
    pass  
  
rdc = RedisCache() # å®ä¾‹åŒ–çš„æ—¶å€™æ²¡æœ‰å®ç°è¿™ä¿©æ–¹æ³•å°±æŠ¥é”™
```
è¿è¡Œç»“æœ
```
Traceback (most recent call last):
  File "/Users/jack/code/py/AdvancedPython/main.py", line 69, in <module>
    rdc = RedisCache()
TypeError: Can't instantiate abstract class RedisCache with abstract methods get, set
```
:::

åœ¨åˆ¤æ–­ç±»å‹çš„æ—¶å€™ï¼Œæ¯”å¦‚åˆ¤æ–­`isinstance(obj,Sized)` å®é™…ä¸Šæ˜¯åˆ¤æ–­äº†objæ˜¯å¦å®ç°`__len__` ä½¿ç”¨çš„æ˜¯`__subclasshook__(cls, C)`  
æ‘˜ä¸€ä¸‹`collection/abc.py Sized`æºç 

:::details Click to see more

```python
# collections/abc.pyä¸­çš„æºç 

class Sized(metaclass=ABCMeta):

    __slots__ = ()

    @abstractmethod
    def __len__(self):
        return 0

    @classmethod
    def __subclasshook__(cls, C): # æ³¨æ„è¿™ä¸ªæ–¹æ³•
        if cls is Sized:
            return _check_methods(C, "__len__")
        return NotImplemented


# ç¤ºä¾‹ä»£ç 
from collections.abc import Sized  
  
isinstance(c, Sized) # cçš„ç±»å®ç°äº†__len__ æ‰€ä»¥è¿”å›ä¸ºTrue

```
è¿è¡Œç»“æœ
```
True
```
:::

æŠ½è±¡åŸºç±»ä½¿ç”¨äº†å…ƒç±»æ¥è¿›ç±»å‹æ£€æŸ¥ï¼Œcollections.abcé‡Œé¢éƒ½ä½¿ç”¨äº†metaclass  
å®é™…ä¸Šå†…ç½®çš„å¸¸ç”¨ç±»å‹ä¹Ÿä¸æ˜¯ä½¿ç”¨æŠ½è±¡åŸºç±»å®ç°çš„ï¼ŒCpythonå®ç°çš„æ›´åŠ ç²¾å¦™  
:::tip ğŸ“ŒTip
æ›´æ¨èä½¿ç”¨Mixinå’Œé¸­å­ç±»å‹å®ç°åŠŸèƒ½ï¼Œ**ç»„åˆä¼˜äºç»§æ‰¿**  
ä¸å®ç°å°±æŠ›å‡ºé”™è¯¯å®ç°ç±»ä¼¼æ¥å£çš„åŠŸèƒ½ï¼Œæ›´åŠ çµæ´»
:::


## é­”æ³•å‡½æ•°
åœ¨ç±»ä¸­`__func__()`ç±»ä¼¼çš„å‡½æ•°å°±æ˜¯é­”æ³•å‡½æ•°ï¼Œä¸€èˆ¬ä¸éœ€è¦è‡ªå®šä¹‰ï¼Œç³»ç»Ÿæå‰å®šä¹‰å¥½è‡ªå·±é‡è½½å³å¯ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶ç‰¹æ€§.
***é­”æ³•å‡½æ•°ä¸æ˜¯objectçš„æ–¹æ³•***,ä¸æ˜¯ç»§æ‰¿æ¥çš„  
pythonçš„è¯­æ³•å’Œå†…ç½®å‡½æ•°ä¼šè¯†åˆ«è‡ªå®šä¹‰å¯¹è±¡é‡Œé¢çš„é­”æ³•å‡½æ•°ï¼Œéšå¼è°ƒç”¨ï¼Œé€šè¿‡é­”æ³•å‡½æ•°å®šä¹‰ï¼Œå¯ä»¥ä½¿å¯¹è±¡å…·æœ‰æŸäº›ç‰¹æ€§ï¼Œ"æˆä¸º"æŸäº›ç±»å‹ï¼Œå®é™…ä¸Šä¸æ˜¯è¿™äº›ç±»å‹ï¼Œæ˜¯é¸­å­ç±»å‹çš„åŠŸèƒ½ï¼ŒåŒºåˆ«äºjavaä¸­éœ€è¦ç»§æ‰¿ç‰¹å®šçš„ç±»æˆ–è€…æ¥å£   
  
è¿™ç§åšæ³•å«åš<span style="background:greenyellow">åè®®</span>ï¼Œå°½é‡éµå®ˆåè®®ç¼–ç¨‹
### å®ç°é€‚åº”lenå’Œfor
`__len__(self)`ä¼šè¢«å†…ç½®å‡½æ•°`len()`è°ƒç”¨ï¼Œè¦æ±‚è¿”å›ä¸€ä¸ªæ•´æ•°  
å®é™…ä¸Šlenå†…ç½®æ•°æ®ç»“æ„çš„æ—¶å€™list setè¿™ç§ï¼Œç›´æ¥è¯»å–cpythonç»´æŠ¤åœ¨å†…å­˜ä¸­è®°å½•ï¼Œå¾ˆå¿«å°±è¿”å›ï¼Œä¸ä¼šå‚»ä¹ä¹å»æ•°é•¿åº¦ã€‚æ‰€ä»¥å°½é‡ä½¿ç”¨å†…éƒ¨å®šä¹‰çš„ä¸œè¥¿ã€‚

`__getitem__(self,item)`,ä½¿ç”¨forçš„æ—¶å€™ï¼Œè§£é‡Šå™¨å…ˆæ‰¾`__iter__()`æ‰¾ä¸åˆ°å°±ä¼šå¯»æ‰¾è¿™ä¸ªå‡½æ•°ï¼Œä»1å¼€å§‹å–ç›´åˆ°`StopIteration`  
å®é™…ä¸Šé€šè¿‡è¿™ä¸ªå‡½æ•°æˆä¸ºäº†åºåˆ—ç±»å‹ï¼Œå°±å¯åˆ‡ç‰‡äº†ã€‚  

:::details Click to see more

```python
class Company(object):  
    def __init__(self, employee_list):  
        self.employee = employee_list  
  
    def __getitem__(self, item):  
        # è¿™é‡Œå¯ä»¥æ”¾ä¸€äº›æ£€æŸ¥ä»£ç ï¼Œéšä½ äº†  
        return self.employee[item]  
  
    def __len__(self):  
        return 10  
  
  
c = Company(["1", "2", "3"])  
for i in c:  
    print(i)  
print("é•¿åº¦æ˜¯",len(c))
```
è¿è¡Œç»“æœ
```
1
2
3
é•¿åº¦æ˜¯ 10
```
:::

### æ§åˆ¶æ‰“å°å¯¹è±¡çš„è¾“å‡º
`__repr__()`åœ¨å¼€å‘æ¨¡å¼æ¯”å¦‚jupyterç›´æ¥è°ƒç”¨æ˜¾ç¤ºçš„  
`__str__()`printå®ƒæ˜¾ç¤ºå•¥  
:::details Click to see more

```python
class Demo2(object):  
    def __str__(self):  
        return "æˆ‘æ˜¯ğŸ¦ˆ"  
  
    def __repr__(self):  
        return "ä½ çŒœæˆ‘æ˜¯ğŸ˜¦ä¸ª"  
  
  
d = Demo2()  
print(d)  
d
```
è¿è¡Œç»“æœ
```
æˆ‘æ˜¯ğŸ¦ˆ
ä½ çŒœæˆ‘æ˜¯ğŸ˜¦ä¸ª
```
:::

### æ•°å­¦è¿ç®—
ä¸æ˜¯é‡ç‚¹ï¼Œéœ€è¦å•¥ç°æŸ¥è‡ªå·±è¯•è¯•ã€‚  
`__ads__()`ï¼Œç”±abs()è°ƒç”¨  
`__add__()`,+è°ƒç”¨  

:::details Click to see more

```python
class Vector(object):  # åæ ‡ç›¸åŠ   
    def __init__(self, x, y):  
        self.x = x  
        self.y = y  
  
    def __str__(self):  
        return "{0},{1}".format(self.x, self.y)  
  
    def __add__(self, other):  
        return Vector(self.x + other.x, self.y + other.y)  
  
    def __abs__(self):  
        return Vector(abs(self.x), abs(self.y))  
  
  
v1 = Vector(1, 2)  
v2 = Vector(-3, -4)  
v2 = abs(v2)  
v1 = v1 + v2  
print(v1,v2)
```
è¿è¡Œç»“æœ
```
4,6 3,4
```
:::
### å®ç°withè¯­å¥å’Œç®€åŒ–
#### try-finallyè¯­å¥
æ­£å¸¸çš„finallyæ˜¯ç”¨ä½œèµ„æºé‡Šæ”¾çš„ï¼Œæ¯”å¦‚å†™æ–‡ä»¶æ•°æ®åº“å‘ç”Ÿé”™è¯¯ï¼Œåœ¨finallyä¸­closeé‡Šæ”¾èµ„æºã€‚  
åœ¨å‡½æ•°ä¸­try-finallyå¤šä¸ªreturnçš„æ—¶å€™ï¼Œæ³¨æ„é¡ºåº

:::details Click to see more

```python
def fun():  
    try:  
        print("rise")   
        raise KeyError  # 1 å‡ºé”™äº†
        return 1   # ä¸æ‰§è¡Œ
    except KeyError as e:  
        print("catch")  # æ•è·æ‰§è¡Œ
        return 2  # å‹æ ˆ
    else:  
        print("other Error")  
        return 3  
    finally:  
        print("finally")  # å¿…æ‰§è¡Œ
        return 4  # å‹æ ˆ
print(fun()) # ä»æ ˆé¡¶å–ä¸€ä¸ªï¼Œæ‰€ä»¥æœ€åfunè¿”å›æ˜¯4ï¼Œå¦‚æœfinallyæ²¡è¿”å›è¯­å¥ï¼Œé‚£ä¹ˆæ ˆé¡¶æ˜¯2ï¼Œè¿”å›çš„å°±æ˜¯2
```
è¿è¡Œç»“æœ
```
rise
catch
finally
4 # è¿”å›å€¼
```
:::

#### å®ç°with
ä¸Šä¸‹æ–‡ç®¡ç†å™¨å°±æ˜¯ç®€åŒ–äº†try-finallyæ•´å‡ºæ¥çš„  
å®ç°äº†ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œç±»ä¼¼äºwith-open  
å®ç°`__enter__(self)`æœ€åè¦è¿”å›self  
åŒæ—¶å®ç°`__exit__(self, exc_type, exc_val, exc_tb)` å¯ä»¥ä¸è¿”å›

:::details Click to see more

```python
class ContextManager:  
  
    def __enter__(self):  
        print("å¼€å§‹")  
        return self  
  
    def __exit__(self, exc_type, exc_val, exc_tb):  
        print("é€€å‡º")  
  
    def func(self):  
        print("åŠŸèƒ½ä»£ç ")  

with ContextManager() as cm:  
    cm.func()
```
è¿è¡Œç»“æœ
```
å¼€å§‹
åŠŸèƒ½ä»£ç 
é€€å‡º
```
:::

#### contextlibç®€åŒ–with
pythonå†…ç½®äº†è£…é¥°å™¨  `@contextlib.contextmanager`å¯ä»¥ç›´æ¥ç®€åŒ–è¿™ä¸œè¥¿  
è¢«è£…é¥°å‡½æ•°ä¸­éœ€è¦å«æœ‰ä¸€ä¸ª`yield`ï¼Œ`yield`ä¹‹å‰çš„æ˜¯`__enter__`çš„å¤„ç†ï¼Œä¹‹åæ˜¯`__exit__`çš„å¤„ç†  
ä½¿ç”¨äº†yeildç”Ÿæˆå™¨ï¼Œåé¢ä¼šå†™åˆ°ï¼Œè¿™é‡Œå°±æœ‰æ ·å­¦æ ·yieldç©ºå­—å…¸å°±è¡Œ  
:::details Click to see more

```python
from contextlib import contextmanager  
  
@contextmanager  
def ContextManager():  
    print("å¼€å§‹")  
    yield {}  
    print("é€€å‡º")  
  
with ContextManager() as cm:  
    print("åŠŸèƒ½ä»£ç ")
```
è¿è¡Œç»“æœ
```
å¼€å§‹
åŠŸèƒ½ä»£ç 
é€€å‡º
```
:::

### å±æ€§æ“ä½œä¸‰å‰‘å®¢
[å…ƒç±»ç¼–ç¨‹->](#^25cbec)

### æ„é€ ææ„
[æ„é€ ææ„->](#^e46b78)
### é›¶æ•£çš„åŠŸèƒ½
- å®ç°äº†`__contains__`å¯ä»¥inåˆ¤æ–­,æ‰¾ä¸åˆ°å°±æ‰¾`__getitem__`ï¼Œæ‰€ä»¥å®ç°äº†è¿™ä¹Ÿå¯ä»¥
- åè½¬å®ç°çš„æ˜¯`__reversed__`
- delæœ¬è´¨ä¸Šè°ƒç”¨çš„æ˜¯`__del__`åˆ é™¤çš„
    - å¯ä»¥é‡è½½æ¯”å¦‚åˆ é™¤æ—¶é‡Šæ”¾èµ„æº
- ç±»å±æ€§`cls.__base__`æŸ¥çœ‹ä¸€ä¸ªç±»çš„çˆ¶ç±»
- ä½¿ç”¨`obj.__dict__`æŸ¥çœ‹å¯¹è±¡æ‰€æœ‰çš„å±æ€§
- ä½¿ç”¨`cls.__init__.__default__`æŸ¥çœ‹é»˜è®¤å‚æ•°
- `BOOL: hasattr(class,"funcName")`åˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§
- `getattr(obj,k)`ç­‰ä»·äº`obj.k`
åœ¨threadé‡Œé¢å·²ç»å†™äº†initæ–¹æ³•ï¼Œç›´æ¥`super().__init__(para)`å°±å¯ä»¥æ„å»ºäº†


:::tip ğŸ“„Info
å…¶å®é­”æ³•å‡½æ•°å’Œç±»å†…ç½®å±æ€§å¾ˆå¤šï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹ä»–è®²åˆ°çš„å’Œæˆ‘è‡ªå·±å®éªŒåˆ°çš„  
å‰©ä¸‹çš„å»çœ‹æ–‡æ¡£æœå§
:::


---------

## å…ƒç±»ç¼–ç¨‹
æ§åˆ¶ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹
### è®¡ç®—å±æ€§@property
ä½¿ç”¨`@property`è£…é¥°å™¨å°†å‡½æ•°åŒ…è£…æˆåŠ¨æ€å˜é‡ï¼Œæ›´å®¹æ˜“è°ƒç”¨
:::details Click to see more

```python
from datetime import date, datetime  
  
  
class User():  
    def __init__(self, name, birth):  
        self.name = name  
        self.birth = birth  
        self._age = 0  
  
    def old_get_age(self):  # è€å¼ä»£ç éœ€è¦è°ƒç”¨å‡½æ•°æ¯”è¾ƒéº»çƒ¦  
        return datetime.now().year - self.birth.year  
  
    @property  
    def age(self):  # è£…é¥°ä¹‹åå‡½æ•°åå°±æ˜¯å±æ€§åç›´æ¥è°ƒç”¨  
        return self._age  
  
    @age.setter  # setæ–¹æ³•  
    def age(self, value):  
        self._age = value  
  
  
user1 = User("a", date(year=1988, month=5, day=25))  
  
user1.age = 2  # ç›´æ¥è®¾ç½®  
print(user1.old_get_age(), user1.age)
```
è¿è¡Œç»“æœ
```
34 2
```
:::
### å±æ€§æ“ä½œä¸‰å‰‘å®¢
`__getattr__` å°è¯•è·å–ä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœå®šä¹‰äº†æ­¤æ–¹æ³•ï¼Œå°±ä¸ä¼šæŠ¥é”™ä¼šè¿è¡Œè¿™ä¸ªæ–¹æ³•,è¿™ä¸ªè‹¥æ˜¯è¿è¡Œäº†é‚£ä¸‹é¢é‚£ä¸ªå¿…å¤‡è¿è¡Œ  
`__getattribute__` è¿™ä¸ªåªè¦æ‰¾å°±ä¼šè¿›å…¥ï¼Œä¸€èˆ¬ä¸å»ºè®®é‡è½½ï¼Œå¾ˆå®¹æ˜“å´©ã€‚ #TODO å¦‚ä½•å½“æˆä¸€ä¸ªç®¡é“ï¼Ÿä¸‹é¢è¿™ä¸‰ä¸ªå‡½æ•°
Pythonä¸­å±æ€§æ“ä½œæ•è·çš„ä¸‰å‰‘å®¢ï¼š`__ getattribute__`æ–¹æ³•ã€`__setattr__æ–¹æ³•ã€` `__delattr__æ–¹æ³•` ^25cbec

:::details Click to see more

```python
class User1():  
    def __init__(self, name):  
        self.name = name  
  
    def __getattr__(self, item): # æ‰¾ä¸åˆ°æ‰è¿›æ¥  
        print(type(item))  
        return "get {0} error".format(item)  
  
    def __getattribute__(self, item): # åªè¦æ‰¾å°±è¿›æ¥  è¿™é‡Œæœ‰BUG
        print("seeking attr")  
        return item  
  
  
user1 = User1("a")  
print(user1.name)
```
è¿è¡Œç»“æœ
```
seeking attr
<class 'str'>
a get age error
```
:::

### å±æ€§æè¿°ç¬¦descriptor
è¿™é‡Œæœ‰ä¸€ç¯‡[åˆ«äººçš„](https://www.waynerv.com/posts/python-descriptor-in-detail/)  
å½“æˆ‘ä»¬çš„ç±»æœ‰å¾ˆå¤šå±æ€§ï¼Œéƒ½éœ€è¦å†™æ£€æŸ¥æ–¹æ³•çš„æ—¶å€™ï¼Œä¸€ä¸ªå±æ€§ä¸€å¥—æ£€æŸ¥æ–¹æ³•ä»£ç é‡å¤åº¦å¾ˆé«˜ï¼Œæ­¤æ—¶å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»ä¸“é—¨è¿›è¡Œå±æ€§æ£€æŸ¥å¤„ç†ç­‰ï¼Œå®ç°`__get__` `__set__` `__delete__`ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œè¿™ä¸ªç±»å°±æˆäº†å±æ€§æè¿°ç¬¦  
å’Œdjangoé‡Œé¢moduleçš„é€»è¾‘æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯djangoå†™çš„æ›´åŠ åŠ¨æ€å’Œçµæ´»ï¼Œä¹Ÿæ˜¯å¤§éƒ¨åˆ†ORMçš„å®ç°åŸç†  

:::details Click to see more

```python
import numbers  
class IntField():  
    def __get__(self, instance, owner):  
        print("gettingã€‚ã€‚ã€‚")  
        return self.value # è·å–çš„æ—¶å€™å°±è¿”å›å­˜å‚¨çš„å€¼  
  
    def __set__(self, instance, value):  
        print("settingã€‚ã€‚ã€‚")
        if not isinstance(value,numbers.Integral):  
            raise ValueError("int is needed")  
        #æ³¨æ„æ£€æŸ¥å®Œäº†ä¸è¦èµ‹ç»™instance,  
        #å› ä¸ºinstanceå°±æ˜¯Userå¯¹è±¡ï¼Œåˆå›æ¥äº†ä¼šæ­»å¾ªç¯  
        self.value=value  
  
    def __delete__(self, instance):  
        print("deleteã€‚ã€‚ã€‚")  
        pass  
  
class User():  
    age=IntField()  
  
user=User()  
user.age=4  
print(user.age)  
del(user.age)
```
è¿è¡Œç»“æœ
```
settingã€‚ã€‚ã€‚
gettingã€‚ã€‚ã€‚
4
deleteã€‚ã€‚ã€‚
```
:::

æ ¹æ®æ‰€å®ç°çš„åè®®æ–¹æ³•ä¸åŒï¼Œæè¿°ç¬¦åˆå¯åˆ†ä¸ºä¸¤ç±»ï¼š  
  
-   è‹¥å®ç°äº† `__set__()` æˆ– `__delete__()` ä»»ä¸€æ–¹æ³•ï¼Œè¯¥æè¿°ç¬¦æ˜¯ä¸€ä¸ªæ•°æ®æè¿°ç¬¦ï¼ˆ`data descriptor`ï¼‰ã€‚
-   è‹¥ä»…å®ç° `__get__()` æ–¹æ³•ï¼Œè¯¥æè¿°ç¬¦æ˜¯ä¸€ä¸ªéæ•°æ®æè¿°ç¬¦ï¼ˆ`non-data descriptor`ï¼‰ã€‚
  
ä¸¤è€…çš„åœ¨è¡¨ç°è¡Œä¸ºä¸Šå­˜åœ¨å·®å¼‚ï¼š  
  
-   æ•°æ®æè¿°ç¬¦æ€»æ˜¯ä¼šè¦†ç›–å®ä¾‹å­—å…¸ `__dict__` ä¸­çš„å±æ€§ã€‚
    - å®šä¹‰å®ä¾‹ `__dict__[attr]`ä¹‹åè°ƒç”¨ `__dict__[attr]`æˆ–`obj.attr`è¿˜æ˜¯ä¼šä½¿ç”¨æè¿°ç¬¦
    - ä½¿ç”¨äº†æ•°æ®æè¿°ç¬¦ä¼šè¢«å­˜å‚¨åœ¨ç±»çš„æ•°æ®æè¿°ç¬¦ä¸­ï¼Œä¸è¿›å…¥å®ä¾‹çš„ `__dict__` å±æ€§åˆ—è¡¨
-   è€Œéæ•°æ®æè¿°å¯èƒ½ä¼šè¢«å®ä¾‹å­—å…¸ `__dict__` ä¸­å®šä¹‰çš„å±æ€§æ‰€è¦†ç›–ã€‚
    - ä¼˜å…ˆçº§ä¸å¦‚ç±»é«˜ï¼Œæ³¨æ„ä¸‹é¢è¯´æ˜é¡ºåº
:::tip ğŸ“„Info
**æè¿°ç¬¦æŸ¥æ‰¾è¿‡ç¨‹**<br/>
```python
user.ageç­‰ä»·äºgetattr(user,â€™ageâ€™)

è€Œå¯¹äºæè¿°ç¬¦__get__çš„è°ƒç”¨æ˜¯å‘ç”Ÿåœ¨__getattribute__å†…éƒ¨çš„ã€‚
è°ƒç”¨é¡ºåº
è°ƒç”¨__getattribute__
if ç±»å®šä¹‰äº†__getattr__æ–¹æ³• && è°ƒç”¨æŠ›å‡º AttributeError :
    è°ƒç”¨__getattr__

user = User(), é‚£ä¹ˆuser.age é¡ºåºå¦‚ä¸‹ï¼š

if â€œageâ€æ˜¯å‡ºç°åœ¨Useræˆ–å…¶åŸºç±»çš„__dict__ä¸­ && ageæ˜¯data descriptor : 
    è°ƒç”¨å…¶__get__æ–¹æ³•
    
elif â€œageâ€å‡ºç°åœ¨userå¯¹è±¡çš„__dict__ä¸­ :
    ç›´æ¥è¿”å› obj.__dict__[â€˜ageâ€™]

elif â€œageâ€å‡ºç°åœ¨Useræˆ–å…¶åŸºç±»çš„__dict__ä¸­ : 
    if â€œageâ€æ˜¯non-data descriptor : 
        é‚£ä¹ˆè°ƒç”¨å…¶__get__æ–¹æ³•
    else :è¿”å› __dict__[â€˜ageâ€™]

elif Useræœ‰__getattr__æ–¹æ³• : 
    è°ƒç”¨__getattr__æ–¹æ³•
    
else : æŠ›å‡ºAttributeError

```
:::

### å…ƒç±»metaclass

æŠŠclasså®šä¹‰è¯­å¥æ”¾åœ¨å‡½æ•°å†…ï¼Œæ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸åŒè¿”å›ä¸åŒçš„ç±»å¼•ç”¨ï¼Œç„¶ååˆ›å»ºå¯¹åº”çš„å®ä¾‹ï¼Œè¿™ç§åŠ¨æ€åˆ›å»ºå®ä¾‹çš„æœºåˆ¶åœ¨javaè¿™ç§é™æ€è¯­è¨€ä¸­å¾ˆéš¾å®ç°ã€‚  
ä½†æ˜¯pythonåšçš„ä¸æ­¢äºæ­¤ï¼Œè¿˜èƒ½ç»§ç»­åŠ¨æ€  
  
`type(name ,base,dict)`ç±»åï¼ŒåŸºç±»æ²¡æœ‰å°±ç©ºtupleï¼Œå±æ€§æ²¡æœ‰å°±ç©ºå­—å…¸  
è¿™ç§åˆ›å»ºç±»çš„ç±»å°±æ˜¯å…ƒç±»ï¼Œ`type`æ˜¯ä¸€ç§å…ƒç±»ï¼Œç»§æ‰¿typeä¹‹åå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„ç±»(å…¶ä»–éƒ½ç»§æ‰¿è‡ªobject): å…ƒç±»ï¼Œåˆ©ç”¨åˆ›å»ºç±»æ—¶çš„**metaclass**å‚æ•°å°±å¯ä»¥æ§åˆ¶ç±»çš„ç”Ÿæˆè¿‡ç¨‹   
:::details Click to see more
**typeç”Ÿæˆ**<br/>
```python
class BaseClass:  
    def echo(self):  
        print("I am BaseClass")  
  
def boundFun(self,string): # æ³¨æ„ç»‘å®šçš„æ—¶å€™ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤ä¼ å…¥å¯¹è±¡  
    print(self.att)  
    print(string)  
#ä½¿ç”¨typeåˆ›å»ºäº†ä¸€ä¸ªç±»  
T=type("T",(BaseClass,),{"bound":boundFun,"att":"dynamic att"})  
  
t=T()  
t.echo()  
t.bound("para fun")
```
è¿è¡Œç»“æœ
```
I am BaseClass
dynamic att
para fun
```
:::
ç±»çš„ç”Ÿæˆè¿‡ç¨‹  
metaclasså¯ä»¥éšå¼åœ°ç»§æ‰¿åˆ°å­ç±»ï¼Œä½†å­ç±»è‡ªå·±å´æ„Ÿè§‰ä¸åˆ°  
åˆ›å»ºç±»æ—¶ä¼šé¦–å…ˆå¯»æ‰¾metaclassï¼Œï¼Œé€šè¿‡metaclassåˆ›å»ºï¼Œç±»æ‰¾ä¸åˆ°å°±å»çˆ¶ç±»æ‰¾ï¼Œå…ˆæ‰¾åˆ°é‚£ä¸ªå°±ä½¿ç”¨å“ªä¸ªmetaclassï¼Œéƒ½æ‰¾ä¸åˆ°å°±ä¼šå»ç”¨typeåˆ›å»º  
æŠ½è±¡åŸºç±»ä½¿ç”¨äº†å…ƒç±»æ¥è¿›ç±»å‹æ£€æŸ¥ï¼Œcollections.abcé‡Œé¢éƒ½ä½¿ç”¨äº†metaclass  
:::details Click to see more

```python
class MetaClass(type):  
    def __new__(cls, *args, **kwargs):  
        print("new...")  
        print('this is args : ',args) #æ‰“å°ä¸€ä¸‹  
        print('this is kwargs : ',kwargs)  
        kwargs={} # æŠŠä»–ç½®ä¸º{}å› ä¸ºåŸå…ˆå°±æ˜¯ç©ºï¼Œå¦‚æœä¸ç½®ç©ºxä¼ è¿›å»æŠ¥é”™  
        return super().__new__(cls,*args, **kwargs)  
  
class M(metaclass=MetaClass,x=5): # ä¼ å…¥äº†é¢å¤–çš„x=5  
    def __init__(self,name):  
        self.name=name  
  
m=M(name="ha")  
print(m.name)
```
è¿è¡Œç»“æœ
```
new...
this is args :  ('M', (), {'__module__': '__main__', '__qualname__': 'M', '__init__': <function M.__init__ at 0x10a7f7280>})
this is kwargs :  {'x': 5}
ha
```
:::
### example-1 å…ƒç±»å®ç°ORM
åˆ©ç”¨å…ƒç±»è‡ªå·±å†™ä¸ªORM  


------------

## å¸¸è§çš„å†…ç½®ç±»å‹ä¸€è§ˆ
åé¢ä¼šè¯¦ç»†è®²è§£ä¸€äº›ç±»å‹  
pythonçš„å¯¹è±¡ä¼šæœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œèº«ä»½ï¼Œç±»å‹ï¼Œå€¼  

:::tip ğŸ“„Info
pythonçš„å†…ç½®å‡½æ•°éƒ½æ˜¯**å†…åµŒåœ¨è§£é‡Šå™¨é‡Œ**é¢çš„ï¼Œæ˜¯ä½¿ç”¨Cç¼–å†™çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä½ æ˜¯æ— æ³•æŸ¥çœ‹çš„ï¼Œåªä¸è¿‡pycharmè¿™ç§æ™ºèƒ½ç¼–è¾‘å™¨å¯¹å…¶è¿›è¡Œäº†ä¸€ä¸ªæŠ½è±¡ç½¢äº†ï¼Œå¯ä»¥è®©ä½ æŸ¥çœ‹ç›¸åº”çš„æ³¨é‡Šã€‚  
ä»£ç çš„å…·ä½“å®ç°æ˜¯é€šè¿‡Cå®ç°çš„ï¼Œè¯¥æ–‡ä»¶åªæ˜¯èµ·åˆ°ä¸€ä¸ªè®©ä½ å­¦ä¹ çš„è¾…åŠ©ä½œç”¨ã€‚  
:::

### èº«ä»½(å†…å­˜)

ç†è§£ä¸ºå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨`id()`æŸ¥çœ‹  

#### isinstance,is,== çš„åŒºåˆ†
- `isinstance(obj,type)` ä¸ä»…å¯ä»¥åˆ¤æ–­æ˜¯å¦å®ç°äº†ABCï¼Œä¹Ÿä¼šé¡ºç€ç»§æ‰¿é“¾åˆ¤æ–­ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯çˆ¶ç±»å‹ä¹Ÿæ˜¯ç”¨å®ƒï¼Œå­ç±»å‹å¯¹è±¡æ˜¯çˆ¶ç±»å‹çš„ï¼Œå€’è¿‡æ¥ä¸æ˜¯æ˜¯ä¸æ˜¯çˆ¶ç±»å‹ä¹Ÿæ˜¯ç”¨å®ƒï¼Œå­ç±»å‹å¯¹è±¡æ˜¯çˆ¶ç±»å‹çš„ï¼Œå€’è¿‡æ¥ä¸æ˜¯  
- `issubclass(class,type)`åˆ¤æ–­æ˜¯å¦ä¸ºå­ç±»ã€‚  
è¿™ä¿©å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¸ºtupleï¼Œåªè¦å…¶ä¸­æœ‰ä¸€ä¸ªç¬¦åˆå³ä¸ºTrueï¼Œè‡ªå·±åˆ¤æ–­ä¹Ÿç®—ã€‚
- `is` åˆ¤æ–­çš„æ˜¯idæ˜¯å¦ç›¸åŒ
- `â• â•` åˆ¤æ–­çš„æ˜¯å€¼ç›¸ç­‰

#### æ·±æµ…æ‹·è´
æ·±æ‹·è´éœ€è¦å¼•å…¥`copy`åŒ…  
1. **b = a:** èµ‹å€¼å¼•ç”¨ï¼Œa å’Œ b éƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚
2. **b = a.copy():** æµ…æ‹·è´, a å’Œ b æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œä½†ä»–ä»¬çš„å­å¯¹è±¡è¿˜æ˜¯æŒ‡å‘åŒä¸€å¼•ç”¨,dictå¥—listï¼Œæ‹·è´å®Œåä¿©dictçš„listæŒ‡å‘åŸå…ˆçš„åŒä¸€ä¸ªlist
3. **b = copy.deepcopy(a):** æ·±åº¦æ‹·è´, a å’Œ b å®Œå…¨æ‹·è´äº†å¯¹è±¡åŠå…¶å­å¯¹è±¡ï¼Œä¸¤è€…æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚

### ç±»å‹

è¿™äº›ç±»å‹å’Œjavaæœ‰ä¸€å®šåŒºåˆ«  
Noneåœ¨pythonå¯åŠ¨è§£é‡Šå™¨çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨None classå£°æ˜ä¸€ä¸ªNoneï¼Œå…¨å±€åªæœ‰ä¸€ä¸ªï¼Œæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæ— è®ºèµ‹å€¼ç»™å¤šå°‘ä¸ªå˜é‡ä½¿ç”¨idæŸ¥çœ‹æ˜¯ä¸€æ ·çš„  
**å¸¸è§ç±»å‹**  

- æ•°å€¼
    - int
    - float
    - complex
    - bool
- è¿­ä»£ç±»å‹
- åºåˆ—ç±»å‹
    - list
    - bytesã€bytearrayã€memoryviewï¼ˆäºŒè¿›åˆ¶åºåˆ—ï¼‰
    - range
    - tuple
    - str
    - array
- æ˜ å°„ç±»å‹(dict)
- é›†åˆç±»å‹(æ€§èƒ½å¾ˆé«˜)
    - set
    - frozenset(ä¸å¯ä¿®æ”¹çš„set)
- ä¸Šä¸‹æ–‡ç®¡ç†ç±»å‹(withè¯­å¥)
- å…¶ä»–ç±»å‹
    - æ¨¡å—ç±»å‹
    - classå’Œå®ä¾‹
    - å‡½æ•°ç±»å‹
    - æ–¹æ³•ç±»å‹(åŒºåˆ«äºå‡½æ•°)
    - ä»£ç ç±»å‹
    - objectå¯¹è±¡
    - typeç±»å‹
    - ellipsisç±»å‹(`...`çœç•¥å·)
    - notimplementedç±»å‹

### å€¼
`a=1` pythonä¼šæŠŠ1ç”¨`int`å°è£…ä¸ºå¯¹è±¡ï¼Œç„¶åæŠŠaè¿™å˜é‡æŒ‡å‘äº†å®ƒ  

#### å¯¹è±¡å¼•ç”¨,å¯å˜æ€§,GC
javaå’Œpyä¸­çš„å˜é‡æœ¬è´¨ä¸ä¸€æ ·ï¼ŒJVMéœ€è¦å¯¹è¿™ç±»å‹çš„æè¿°ç„¶åç”³è¯·ç©ºé—´ï¼Œæ‰€ä»¥æœ‰å¼ºåˆ¶ç±»å‹æ£€æŸ¥ç©ºé—´å¤§å°ä¹Ÿæ˜¯é¢„å®šçš„  
pythonçš„å˜é‡å®è´¨ä¸Šæ˜¯ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆå¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æŒ‡å‘æ˜¯ä»»æ„çš„ï¼Œè€Œä¸”æ˜¯é¦–å…ˆç”³è¯·äº†å¯¹è±¡å†æŒ‡ä¸Šå»  

#### ä¸¤ç§å‚æ•°ä¼ é€’ å’Œ ä¸å¯å˜å¯¹è±¡
Pythonæ ¹æ®å®é™…å‚æ•°çš„ç±»å‹ä¸åŒï¼Œåˆ†åˆ«ä½¿ç”¨å€¼ä¼ é€’å’Œå¼•ç”¨ï¼ˆåœ°å€ï¼‰ä¼ é€’ï¼š

1.  å€¼ä¼ é€’ï¼šé€‚ç”¨äºå®å‚ç±»å‹ä¸ºä¸å¯å˜ç±»å‹ï¼ˆ**å­—ç¬¦ä¸²ã€æ•°å­—ã€å…ƒç»„**ï¼‰
2.  å¼•ç”¨ï¼ˆåœ°å€ï¼‰ä¼ é€’ï¼šé€‚ç”¨äºå®å‚ç±»å‹ä¸ºå¯å˜ç±»å‹ï¼ˆ**åˆ—è¡¨ï¼Œå­—å…¸**ï¼‰

åŒºåˆ«æ˜¯ï¼Œå‡½æ•°å‚æ•°è¿›è¡Œå€¼ä¼ é€’åï¼Œè‹¥å½¢å‚å˜ï¼Œå®å‚ä¸å˜ï¼›  
è€Œå‡½æ•°å‚æ•°ç»§ç»­å¼•ç”¨ä¼ é€’åï¼Œè‹¥å½¢å‚å˜ï¼Œå®å‚ä¹Ÿå˜  

pythonå†…éƒ¨æœ‰internä¼˜åŒ–æœºåˆ¶ï¼Œå°†ä¸€å®šèŒƒå›´çš„å°æ•´æ•°å°å­—ç¬¦ä¸²ï¼Œå…¨å±€åŒ–å­˜å‚¨ï¼Œå…¶ä»–å¯¹è±¡å†ç”³è¯·å°æ•´æ•°ç›´æ¥æŒ‡å‘è¿™ä¸ªæ•´æ•°å¯¹è±¡
è‡ªå®šä¹‰çš„ç±»æœ¬èº«ä¹Ÿæ˜¯å…¨å‰§å”¯ä¸€çš„å¯¹è±¡ï¼Œæ‰€ä»¥è¿™æ—¶å€™ä½¿ç”¨idæŸ¥çœ‹ä¼šå‘ç°æ˜¯åŒä¸€ä¸ª  
å½“å¯¹ä¸å¯å˜å¯¹è±¡é‡æ–°èµ‹å€¼çš„æ—¶å€™ï¼Œä¼šé‡æ–°å¼€è¾Ÿä¸€æ®µå†…å­˜ç©ºé—´ï¼Œå¹¶å°†åœ°å€å¼•ç”¨æŒ‡å‘æ–°å¼€è¾Ÿçš„ç©ºé—´ï¼ŒåŸæœ‰çš„å†…å­˜ç©ºé—´å°†è¢«å›æ”¶  

#### åƒåœ¾å›æ”¶
é‡‡ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•ï¼Œ2.0ä½¿ç”¨åˆ†ä»£çš„åƒåœ¾å›æ”¶ï¼Œå¼•ç”¨æ•°é‡ä¸º0çš„æ—¶å€™å›æ”¶ã€‚
delæœ¬è´¨ä¸Šè°ƒç”¨çš„æ˜¯`__del__`åˆ é™¤çš„,å¯ä»¥é‡è½½æ¯”å¦‚åˆ é™¤æ—¶é‡Šæ”¾èµ„æº  

--------

## åºåˆ—ç±»å‹
### åˆ†ç±»
- åºåˆ—ç±»å‹çš„ç±»å‹åˆ†ç±»
	- å®¹å™¨åºåˆ— (æ”¾ç½®ä»»æ„ç±»å‹)
		- listã€tupleã€deque
	- æ‰å¹³åºåˆ—ï¼ˆå¿…é¡»æŒ‡æ˜æ•°æ®ç±»å‹ï¼‰
		- strã€bytesã€bytearrayã€array.array
- å±æ€§åˆ†ç±»
	- å¯å˜åºåˆ—
		- listï¼Œ dequeï¼Œbytearrayã€array
	- ä¸å¯å˜
		- strã€tupleã€bytes

### åºåˆ—åè®®
ç”¨æ³•å¯ä»¥çœ‹[pythonåº“](pythonåº“.md)çš„collectionséƒ¨åˆ†ï¼Œè¿™é‡Œä¸»è¦æ¢è®¨åŸç†  
`collectios.abc`é‡ŒæŸ¥çœ‹å„ç§ç±»å‹å®ç°äº†ä»€ä¹ˆåè®®  
æ¯”å¦‚åºåˆ—å®ç°çš„ABCæ˜¯  

![](./static/pythonè¯­è¨€è¿›é˜¶-images-3.svg)
#### åºåˆ—+=å’Œ+
+ä¸ä¼šæ”¹å˜åŸåºåˆ—ï¼Œè€Œ+=æ˜¯å°±åœ°åŠ ï¼Œæ— è¿”å›å€¼ç›´æ¥åŠ è¿›åŸæ¥çš„  
+å¿…é¡»ä¸ºä¸¤ä¸ªlistç›¸åŠ ï¼Œè€Œ+=åé¢å¯ä»¥æ˜¯ä»»æ„çš„åºåˆ—  
+=æ˜¯é€šè¿‡`__iadd__` è°ƒç”¨çš„**extend**ï¼Œä¸€ä¸ªä¸ªappendè¿›æ¥çš„ï¼Œæ‰€ä»¥åªè¦æ˜¯`Iterable`å°±å¯ä»¥  
`append([1,2])`ä¼šæ•´ä½“åŠ è¿›å»ä¸ä¼šä¸€ä¸ªä¸ªåŠ   

#### åˆ‡ç‰‡
:::details Click to see more
**ç”¨æ³•å¤ä¹ **<br/>
```python
#æ¨¡å¼[start:end:step]
"""
    å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ªæ•°å­—startè¡¨ç¤ºåˆ‡ç‰‡å¼€å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º0ï¼›
    ç¬¬äºŒä¸ªæ•°å­—endè¡¨ç¤ºåˆ‡ç‰‡æˆªæ­¢ï¼ˆä½†ä¸åŒ…å«ï¼‰ä½ç½®ï¼ˆé»˜è®¤ä¸ºåˆ—è¡¨é•¿åº¦ï¼‰ï¼›
    ç¬¬ä¸‰ä¸ªæ•°å­—stepè¡¨ç¤ºåˆ‡ç‰‡çš„æ­¥é•¿ï¼ˆé»˜è®¤ä¸º1ï¼‰ã€‚
    å½“startä¸º0æ—¶å¯ä»¥çœç•¥ï¼Œå½“endä¸ºåˆ—è¡¨é•¿åº¦æ—¶å¯ä»¥çœç•¥ï¼Œ
    å½“stepä¸º1æ—¶å¯ä»¥çœç•¥ï¼Œå¹¶ä¸”çœç•¥æ­¥é•¿æ—¶å¯ä»¥åŒæ—¶çœç•¥æœ€åä¸€ä¸ªå†’å·ã€‚
    å¦å¤–ï¼Œå½“stepä¸ºè´Ÿæ•´æ•°æ—¶ï¼Œè¡¨ç¤ºåå‘åˆ‡ç‰‡ï¼Œè¿™æ—¶startåº”è¯¥æ¯”endçš„å€¼è¦å¤§æ‰è¡Œã€‚
"""
aList = [3, 4, 5, 6, 7, 9, 11, 13, 15, 17]
print (aList[::])  # è¿”å›åŒ…å«åŸåˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ–°åˆ—è¡¨
print (aList[::-1])  # è¿”å›åŒ…å«åŸåˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„é€†åºåˆ—è¡¨
print (aList[::2])  # éš”ä¸€ä¸ªå–ä¸€ä¸ªï¼Œè·å–å¶æ•°ä½ç½®çš„å…ƒç´ 
print (aList[1::2])  # éš”ä¸€ä¸ªå–ä¸€ä¸ªï¼Œè·å–å¥‡æ•°ä½ç½®çš„å…ƒç´ 
print (aList[3:6])  # æŒ‡å®šåˆ‡ç‰‡çš„å¼€å§‹å’Œç»“æŸä½ç½®
aList[0:100]  # åˆ‡ç‰‡ç»“æŸä½ç½®å¤§äºåˆ—è¡¨é•¿åº¦æ—¶ï¼Œä»åˆ—è¡¨å°¾éƒ¨æˆªæ–­
aList[100:]  # åˆ‡ç‰‡å¼€å§‹ä½ç½®å¤§äºåˆ—è¡¨é•¿åº¦æ—¶ï¼Œè¿”å›ç©ºåˆ—è¡¨

aList[len(aList):] = [9]  # åœ¨åˆ—è¡¨å°¾éƒ¨å¢åŠ å…ƒç´ 
aList[:0] = [1, 2]  # åœ¨åˆ—è¡¨å¤´éƒ¨æ’å…¥å…ƒç´ 
aList[3:3] = [4]  # åœ¨åˆ—è¡¨ä¸­é—´ä½ç½®æ’å…¥å…ƒç´ 
aList[:3] = [1, 2]  # æ›¿æ¢åˆ—è¡¨å…ƒç´ ï¼Œç­‰å·ä¸¤è¾¹çš„åˆ—è¡¨é•¿åº¦ç›¸ç­‰
aList[3:] = [4, 5, 6]  # ç­‰å·ä¸¤è¾¹çš„åˆ—è¡¨é•¿åº¦ä¹Ÿå¯ä»¥ä¸ç›¸ç­‰
aList[::2] = [0] * 3  # éš”ä¸€ä¸ªä¿®æ”¹ä¸€ä¸ª
print (aList)
aList[::2] = ['a', 'b', 'c']  # éš”ä¸€ä¸ªä¿®æ”¹ä¸€ä¸ª
aList[::2] = [1,2]  # å·¦ä¾§åˆ‡ç‰‡ä¸è¿ç»­ï¼Œç­‰å·ä¸¤è¾¹åˆ—è¡¨é•¿åº¦é¡»ç›¸ç­‰,ä¾‹å­æŠ¥é”™äº†
aList[:3] = []  # åˆ é™¤åˆ—è¡¨ä¸­å‰3ä¸ªå…ƒç´ 

del aList[:3]  # åˆ‡ç‰‡å…ƒç´ è¿ç»­
del aList[::2]  # åˆ‡ç‰‡å…ƒç´ ä¸è¿ç»­ï¼Œéš”ä¸€ä¸ªåˆ ä¸€ä¸ª
```
:::
å¦‚ä½•å®ç°è‡ªå®šä¹‰ç±»çš„åˆ‡ç‰‡  
`slice`æ˜¯ä¸€ç§å¯¹è±¡ï¼Œ`[::]`åˆ‡ç‰‡æ—¶å…ˆåˆå§‹åŒ–ä¸€ä¸ªsliceå¯¹è±¡ç„¶åäº¤ç»™`__getitem__`ä½¿ç”¨ï¼Œ`[0]`ä¼ å…¥çš„æ˜¯æ•°å­—ï¼Œç›´æ¥åˆ¤æ–­ç±»å‹é’ˆå¯¹å¤„ç†
```python
def __getitem__(self, item):
        cls = type(self)
        if isinstance(item, slice):
            return cls(...) # æ„å»ºæ„å»º
        elif isinstance(item, numbers.Integral):
            return cls(...) # æ„å»ºæ„å»º
```

[bisectç»´æŠ¤åºåˆ—æœ‰åº](pythonåº“.md#^194418)

### æ•°ç»„array
è¿™ä¸ªæ•°ç»„æ˜¯Cå†™çš„ï¼Œæ€§èƒ½å¾ˆä¸é”™ï¼Œæ€è€ƒä¸€ä¸‹ä»€ä¹ˆæ—¶å€™ä¸åº”è¯¥ç”¨æ•°ç»„å¯ä»¥ç”¨arrayä»£æ›¿  
arrayåªèƒ½å­˜æ”¾æŒ‡å®šç±»å‹çš„æ•°ç»„ï¼Œç”³è¯·æ—¶å…ˆæŒ‡å®šå¥½ç±»å‹  
`a=array.array("i")`  

| Type code |      C Type       | Minimum size in bytes |
|:---------:|:-----------------:|:---------------------:|
|    'b'    |  signed integer   |           1           |
|    'B'    | unsigned integer  |           1           |
|    'u'    | Unicode character |     2 (see note)      |
|    'h'    |  signed integer   |           2           |
|    'H'    | unsigned integer  |           2           |
|    'i'    |  signed integer   |           2           |
|    'I'    | unsigned integer  |           2           |
|    'l'    |  signed integer   |           4           |
|    'L'    | unsigned integer  |           4           |
|    'q'    |  signed integer   |     8 (see note)      |
|    'Q'    | unsigned integer  |     8 (see note)      |
|    'f'    |  floating point   |           4           |
|    'd'    |  floating point   |           8           |

ç”¨æ³•æ³¨é‡Šé‡Œå¤´æœ‰ç”¨æ³•ï¼Œç‚¹è¿›å»çœ‹æºç   
æŒ‡å®šäº†ç±»å‹ç„¶åå†æ·»åŠ å…ƒç´ ï¼Œé‚£ä¸ªinitializeræ²¡çœ‹æ‡‚æ˜¯åœ¨å¹²å•¥ï¼Œå¯èƒ½æ˜¯åˆ©ç”¨è¿™åºåˆ—åˆå§‹åŒ–  

### åˆ—è¡¨ç”Ÿæˆå¼
åˆ—è¡¨ç”Ÿæˆå¼æ€§èƒ½æ˜¯é«˜äºåˆ—è¡¨æ™®é€šæ“ä½œçš„ï¼Œå¯ä»¥ç”¨å‡½æ•°æ¥è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯ä»£ç å¯è¯»æ€§ä¼šä¸‹é™ã€‚  

- ç”¨()äº§ç”Ÿçš„æ˜¯ç”Ÿæˆå™¨
-  {}äº§ç”Ÿçš„æ˜¯setï¼Œå¦‚æœå¸¦k:väº§ç”Ÿçš„å°±æ˜¯å­—å…¸
    - æŠŠæ•°å­—å½“ä½œkeyè®©dictçœ‹èµ·æ¥ä¼šåƒåºåˆ—ï¼Œæœ‰ç—…å•Š

*åˆ†ç±»é‡Œçš„å†…ç½®ç±»å‹éƒ½èƒ½ç”¨ï¼Œæƒ³åˆ°çš„æ—¶å€™çœ‹æ–‡æ¡£*  

## Mappingç±»å‹
### å­—å…¸
#### ABCå’Œæ—¥å¸¸ç”¨æ³•
![](./static/pythonè¯­è¨€è¿›é˜¶-images-4.svg)
ç‚¹è¿›æºç çœ‹æœ‰å“ªäº›æ–¹æ³•ï¼Œå…ˆåˆ—å‡ ä¸ª  

- `fromkeys(iterable,value)`
    - æŠŠiterableä½œä¸ºkeyï¼Œvalueä½œä¸ºé»˜è®¤çš„valueï¼Œç”Ÿæˆå­—å…¸ 
- `keys()`
- `iterms()`
- `get()`
- `setdefault(k:v)`
    - å–å€¼ï¼Œå–ä¸åˆ°å°±è®¾ç½®è¿™å¯¹kvè¿›å»å¹¶ä¸”è¿”å›v
    - å¼ºåŒ–çš„get
- `upadte()`
    - åˆå¹¶å­—å…¸å¯ä»¥æ¥å—å¤šç§å‚æ•°
    - `k=v,[(k,v),(k,v)],{k:v}`

#### dictçš„å­ç±»
:::warning âš ï¸Warning
ä¸è¦ç›´æ¥ç»§æ‰¿å†…ç½®çš„ç±»å‹ï¼Œä»–ä»¬éƒ½æ˜¯Cå†™çš„æœ‰äº›é­”æ³•å‡½æ•°åœ¨å­ç±»é‡Œä¸ç”Ÿæ•ˆ  
ä½¿ç”¨collectionsåº“ä¸­çš„æ¨¡å—è¿›è¡Œè‡ªå®šä¹‰ä¿®æ”¹
:::

`collections.defaultdict`çš„å®ç°æ˜¯ä½¿ç”¨`__missing__`é­”æ³•å‡½æ•°ï¼Œå¦‚æœå–å€¼çš„æ—¶å€™æ‰¾ä¸åˆ°å€¼å°±å»è°ƒç”¨missingé­”æ³•å‡½æ•°

:::warning â“Question
**userdictæºç **<br/>
```python
# userdictæºç 
def __getitem__(self, key):  
    if key in self.data:  
        return self.data[key]  
    if hasattr(self.__class__, "__missing__"):  
        return self.__class__.__missing__(self, key)  # è°ƒç”¨Missing
    raise KeyError(key)
# defaultdictæ–¹æ³•
    def __missing__(self, key): # real signature unknown; restored from __doc__
        """
        __missing__(key) # Called by __getitem__ for missing key; pseudo-code:
          if self.default_factory is None: raise KeyError((key,))
          self[key] = value = self.default_factory()
          return value
        """
        pass
```
:::

defaultdictå…·ä½“ç”¨æ³•çœ‹colletcionsåŒ…

#### seté›†åˆ
æ— åºä¸é‡å¤ï¼Œfrozensetæ˜¯ä¸å¯æ·»åŠ ä¿®æ”¹çš„å€¼ï¼Œä½¿ç”¨hashå®ç°æŸ¥æ‰¾æ€§èƒ½O(1)ï¼Œå¯ä»¥ä½œä¸ºdictçš„keyï¼Œè°ƒç”¨å’Œsetä¸€æ ·  

- `s1.difference(s2)`
    - è¿”å›ä¸€ä¸ªå·®é›†
- é›†åˆçš„å¸¸è§è¿ç®—  
    - `|å¹¶é›†` `&äº¤é›†` `-å·®é›†`  
    - å¹¶äº¤å‰çš„é­”æ³•å‡½æ•°ç”¨åˆ°äº†å†å»æŸ¥ï¼Œæ˜¯æ•°å­¦ç›¸å…³é­”æ³•å‡½æ•°
- è¶…é›†æˆ–å­é›†
    - â€œå°äºâ€ç¬¦å·ï¼ˆ<ã€<=ï¼‰ç”¨æ¥åˆ¤æ–­å­é›†
    - â€œå¤§äºâ€ç¬¦å·ï¼ˆ>ã€ >= ï¼‰ç”¨æ¥åˆ¤æ–­è¶…é›†
    - ç­‰äºå·å…è®¸éä¸¥æ ¼å®šä¹‰çš„å­é›†å’Œè¶…é›†ï¼Œâ€œå°äºâ€ å’Œ â€œå¤§äºâ€æ„å‘³ç€ä¸¤ä¸ªé›†åˆåœ¨æ¯”è¾ƒæ—¶ä¸èƒ½ç›¸ç­‰ã€‚

### å¦‚ä½•å®ç°setå’Œdict
- å¯å“ˆå¸Œçš„(æ˜¯ä¸å¯å˜ç±»å‹)æ‰èƒ½å½“ä½œkey  
- å†…å­˜èŠ±é”€å¤§  
    - å½“è¡¨å°äº1/3çš„æ—¶å€™ï¼Œå°±ä¼šå¦ç”³è¯·ç©ºé—´ä½¿ç”¨æ•°æ®è¿ç§»ç®—æ³•ç§»åŠ¨è¿‡å»
    - åœ¨python3.7ä¹‹ådicté»˜è®¤æœ‰åºäº†
- ä¼˜å…ˆä½¿ç”¨setè¿›è¡Œå»é‡ï¼Œå ç”¨æ¯”dictå°ï¼Œé€Ÿåº¦æ¯”listå¿«

-------

## åˆå§‹åŒ–,æ¨¡å—,å’ŒåŒ…
- `if __name__ == "__main__":` å¯ä»¥é¿å…åœ¨è¢«å¼•å…¥çš„æ—¶å€™ç›´æ¥è¢«æ‰§è¡Œä»£ç 
- åŸºæœ¬ä¿¡æ¯
    - `# -*-coding:utf-8-*-` æŒ‡æ˜æ–‡ä»¶çš„ç¼–ç 
    - `__author__ = "a_little_rubbish"`
    - `__date__ = "2022/5/19 18:06"`

### pythonç¼–ç é£æ ¼è§„èŒƒ
[Python é£æ ¼æŒ‡å— â€” Google å¼€æºé¡¹ç›®é£æ ¼æŒ‡å—](https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/contents/)

Pythonçš„åˆ›å§‹äººä¸ºGuido van Rossumã€‚1989å¹´åœ£è¯èŠ‚æœŸé—´ï¼Œåœ¨é˜¿å§†æ–¯ç‰¹ä¸¹ï¼ŒGuidoä¸ºäº†æ‰“å‘åœ£è¯èŠ‚çš„æ— è¶£ï¼Œå†³å¿ƒå¼€å‘ä¸€ä¸ªæ–°çš„è„šæœ¬è§£é‡Šç¨‹åºï¼Œä½œä¸ºABC è¯­è¨€çš„ä¸€ç§ç»§æ‰¿ã€‚ä¹‹æ‰€ä»¥é€‰ä¸­Pythonï¼ˆå¤§èŸ’è›‡çš„æ„æ€ï¼‰ä½œä¸ºè¯¥ç¼–ç¨‹è¯­è¨€çš„åå­—ï¼Œæ˜¯å–è‡ªè‹±å›½20ä¸–çºª70å¹´ä»£é¦–æ’­çš„ç”µè§†å–œå‰§ã€Šè’™æ.æ´¾æ£®å¹²çš„é£è¡Œé©¬æˆå›¢ã€‹ï¼ˆMonty Python's Flying Circusï¼‰ã€‚  

**pythonä¹‹ç¦…**:
```
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!

```

**ç¿»è¯‘**

```
ä¼˜ç¾ä¼˜äºä¸‘é™‹ï¼Œ
æ˜äº†ä¼˜äºéšæ™¦ï¼›
ç®€å•ä¼˜äºå¤æ‚ï¼Œ
å¤æ‚ä¼˜äºç¹æ‚ï¼Œ
æ‰å¹³ä¼˜äºåµŒå¥—ï¼Œ
ç¨€ç–ä¼˜äºç¨ å¯†ï¼Œ
å¯è¯»æ€§å¾ˆé‡è¦ï¼
ç‰¹ä¾‹äº¦ä¸å¯è¿èƒŒåŸåˆ™ï¼Œ
å³ä½¿å®ç”¨æ¯”çº¯ç²¹æ›´ä¼˜ã€‚
é”™è¯¯ç»ä¸èƒ½æ‚„æ‚„å¿½ç•¥ï¼Œ
é™¤éå®ƒæ˜ç¡®éœ€è¦å¦‚æ­¤ã€‚
é¢å¯¹ä¸ç¡®å®šæ€§ï¼Œ
æ‹’ç»å¦„åŠ çŒœæµ‹ã€‚
ä»»ä½•é—®é¢˜åº”æœ‰ä¸€ç§ï¼Œ
ä¸”æœ€å¥½åªæœ‰ä¸€ç§ï¼Œ
æ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ³•ã€‚
å°½ç®¡è¿™æ–¹æ³•ä¸€å¼€å§‹å¹¶éå¦‚æ­¤ç›´è§‚ï¼Œ
é™¤éä½ æ˜¯è·å…°äººã€‚
åšä¼˜äºä¸åšï¼Œ
ç„¶è€Œä¸å‡æ€ç´¢è¿˜ä¸å¦‚ä¸åšã€‚
å¾ˆéš¾è§£é‡Šçš„ï¼Œå¿…ç„¶æ˜¯åæ–¹æ³•ã€‚
å¾ˆå¥½è§£é‡Šçš„ï¼Œå¯èƒ½æ˜¯å¥½æ–¹æ³•ã€‚
å‘½åç©ºé—´æ˜¯ä¸ªç»å¦™çš„ä¸»æ„ï¼Œ
æˆ‘ä»¬åº”å¥½å¥½åˆ©ç”¨å®ƒã€‚
```

